{% load static records_tags search_tags wagtailimages_tags %}

{% extended_in_operator buckets.current.key bucketkeys.INSIGHT.value bucketkeys.HIGHLIGHT.value as apply_teaser_image %}
{% if apply_teaser_image %}
    {% image record.source_page.teaser_image fill-288x172 as teaser_image_small %}
    {% image record.source_page.teaser_image fill-328x196 as teaser_image_medium %}
    {% image record.source_page.teaser_image fill-348x208 as teaser_image_large %}
    {% image record.source_page.teaser_image fill-508x304 as teaser_image_extra_large %}
{% endif %}

{% comment %} TODO downloadable, and record variables {% endcomment %}

<li class="search-results__list-card" data-iaid="{{ record.iaid }}" data-score="{{ record.score }}">

    <i class="search-results__icon fa-solid fa-file"></i>

    <div class="search-results__list-card-details">
        <h3 class="tna-heading-m">
            <a href="{% if form.group.value == bucketkeys.ARCHIVE.value %}{% record_url record level_or_archive='Archive' form_group=form.group.value %}{% else %}{% record_url record level_or_archive=record.level form_group=form.group.value %}{% endif %}" class="search-results__list-card-heading-link" data-link="{{ record.reference_prefixed_summary_title }}" data-link-type="Search results list" search-bucket="{{ buckets.current.label }}">
                {% if record.reference_number %}
                <span class="sr-only">Reference number {{ record.reference_number }}: </span>
                {% endif %}
                {{ record.summary_title }}
                {# API data required before this can be properly connected to it #}
                (Type)
            </a>
        </h3>

        <p class="search-results__list-card-description">
            {{ record.listing_description }}
        </p>

        <dl class="tna-dl tna-dl--plain tna-!--margin-bottom-s">

            {% comment %}
                Commented out as discussed on https://github.com/nationalarchives/ds-ohos-wagtail/pull/26
                This will require some additional logic once we are working with OHOS data
                {% if record.held_by %}
                    <dt>Held by</dt>
                    <dd>{{ record.held_by }}</dd>
                {% endif %}
            {% endcomment %}

            {% if record.date_created %}
                <dt>Date</dt>
                <dd>
                    <date>{{ record.date_created }}</date>
                </dd>
            {% endif %}

            {% comment %}
                Commented out as discussed on https://github.com/nationalarchives/ds-ohos-wagtail/pull/26
                This will require some additional logic once we are working with OHOS data
                {% if record.reference_number %}
                    <dt>
                        {% if form.group.value == 'archive' %}
                        Archon code
                        {% else %}
                        Reference
                        {% endif %}
                    </dt>
                    <dd>{{ record.reference_number }}</dd>
                {% endif %}

                {% if form.group.value == bucketkeys.CREATOR.value and record.type %}
                    <dt>
                        Type
                    </dt>
                    <dd>{{ record.type }}</dd>
                {% endif %}
            {% endcomment %}

            {# API data required before this can be properly connected to it #}
            <dt>Collection</dt>
            <dd>Hardcoded until API response is available</dd>

        </dl>

        {% include 'includes/tags.html' %}
    </div>
</li>
